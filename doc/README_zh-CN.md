[English](../README.md)

# GSEA GUI 工具集 (GSEA GUI Toolset)

这是一个功能强大的基因集富集分析（GSEA）和可视化工具集，提供了一整套图形用户界面（GUI），用于从数据准备到分析再到结果展示的完整流程。

## 主要功能

本工具集包含三个核心模块：

1.  **基因集富集分析 (Enrichment Analysis)**: 支持超几何分布检验（ORA）和 GSEA 分析。
2.  **结果可视化 (Visualization)**: 支持生成气泡图（Dot Plot）、条形图（Bar Plot）以及 GSEA 专属的富集评分图。
3.  **GMT 文件生成器 (GMT Generator)**: 帮助用户将自定义的注释表格转换为标准的 GMT 格式基因集文件。

## 安装说明

### Pypi安装
```bash
pip install gseagui
```


## 快速开始

安装完成后，可以通过以下命令启动各个工具：

```bash
# 启动主启动器（包含所有工具入口）
gseagui

# 单独启动富集分析工具
gseanrichment

# 单独启动可视化工具
gseaplotter

# 单独启动 GMT 生成器
gmtgenerator
```

---

## 详细使用指南 & 输入文件格式

### 1. 基因集富集分析 (Enrichment Analysis)

该模块用于执行基因富集分析。

#### 输入文件格式

**A. 注释文件 (Annotation File)**
*   **格式**: TSV (制表符分隔) 或 TXT。
*   **内容**: 必须包含至少两列：
    *   **基因/蛋白 ID 列**: 唯一的标识符。
    *   **注释列**: 对应的通路或功能注释（如 GO Term, KEGG Pathway）。
*   **多重注释**: 如果一个基因对应多个注释，支持使用分隔符（如 `|`）分隔。
*   **示例**:

| GeneID | Pathway |
| :--- | :--- |
| GeneA | Pathway1\|Pathway2 |
| GeneB | Pathway1 |
| GeneC | Pathway3 |

**B. 基因列表文件 (Gene List File)**
*   **格式**: TSV (制表符分隔) 或 TXT。
*   **内容**:
    *   **基因列 (必需)**: 待分析的基因 ID。
    *   **排序值列 (GSEA 必需)**: 用于 GSEA 排序的数值（如 log2FoldChange, t-statistic）。
    *   **分组列 (可选)**: 如果需要对不同分组分别进行分析，可以指定分组列。
*   **示例**:

| GeneID | Log2FC | Cluster |
| :--- | :--- | :--- |
| GeneA | 2.5 | Group1 |
| GeneB | -1.2 | Group1 |
| GeneC | 0.5 | Group2 |

**C. GMT 文件**
*   标准的 GMT 格式文件，通常由 GMT 生成器生成或从 MSigDB 下载。

#### 使用步骤
1.  在 "注释处理" 标签页加载 **注释文件**，选择对应的 ID 列和注释列。
2.  点击 "创建基因集" 按钮，构建用于分析的背景库。
3.  切换到 "富集分析" 标签页。
4.  选择输入方式：
    *   **从文件输入**: 加载基因列表文件，选择基因列、排序值列（如做 GSEA）和分组列（可选）。
    *   **直接输入**: 在文本框中粘贴基因列表。
5.  选择分析方法：**超几何分布** 或 **GSEA**。
    *   GSEA 可调整最小/最大基因集大小。
6.  设置输出目录和前缀，点击 "运行富集分析"。

#### 输出结果
*   **TSV 文件**: 包含富集分析的详细统计结果（P-value, FDR, NES 等）。
*   **Pickle (.pkl) 文件**: (可选) 保存完整的分析对象，用于后续在可视化工具中绘制 GSEA 图。

---

### 2. 结果可视化 (Visualization)

该模块用于展示富集分析的结果。

#### 输入文件格式

**A. TSV 结果文件**
*   通常由富集分析模块生成，或符合通用的富集分析结果格式。
*   必需列（自动识别，也可手动指定）：
    *   Term/Pathway 名称
    *   P-value 或 Adjusted P-value (用于颜色映射)
    *   Count/Size (用于点大小)
    *   NES (用于 GSEA 结果展示)

**B. Pickle (.pkl) 文件**
*   由富集分析模块生成的 GSEA 结果对象文件。

#### 功能与图表类型

**1. 气泡图 (Dot Plot)**
*   **适用**: 展示富集通路及其显著性。
*   **参数**:
    *   **Column**: 映射到点大小或颜色的数值列。
    *   **X/Group**: X 轴分组。
    *   **Hue**: 颜色映射列。
    *   **阈值**: 过滤不显著的通路。
    *   **样式**: 可调整点大小缩放、形状、颜色映射 (Colormap)。

**2. 条形图 (Bar Plot)**
*   **适用**: 简单展示 Top 通路。
*   **参数**: 支持自定义颜色、图例位置等。

**3. GSEA 富集图 (GSEA Plot)**
*   **适用**: 仅限加载 PKL 文件后使用。
*   **功能**: 绘制经典的 GSEA 跑分图 (Running Enrichment Score)。
*   **交互**: 在列表中选择一个或多个 Term 进行绘制。支持显示/隐藏 Ranking metric，调整图例位置和字体大小。

---

### 3. GMT 文件生成器 (GMT Generator)

该模块用于制作自定义的 GMT 文件。

#### 输入文件格式
*   同 **富集分析** 中的 **注释文件**。

#### 使用步骤
1.  加载注释文件 (TSV/TXT)。
2.  选择 **ID 列** 和 **注释列**。
3.  **注释处理设置**:
    *   **启用注释分割**: 如果单元格内包含多个注释（如 `GO:001|GO:002`），勾选此项并设置分隔符（如 `|`）。
    *   **最小基因数**: 过滤掉基因数量过少的通路。
    *   **无效值**: 排除包含特定字符（如 `nan`, `None`）的行。
4.  设置输出目录，点击 "生成 GMT 文件"。

#### 输出结果
*   **.gmt 文件**: 符合标准格式，可直接用于 GSEA 分析或 GSEA 软件。
    *   格式: `PathwayName  NA  Gene1  Gene2  Gene3 ...`

## 许可证

本项目采用 BSD 许可证。
